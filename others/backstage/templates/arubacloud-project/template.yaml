apiVersion: scaffolder.backstage.io/v1beta3
kind: Template
metadata:
  name: arubacloud-project
  title: Create ArubaCloud Project
  description: Creates a Project Custom Resource (arubacloud.com/v1alpha1) and applies it directly to the cluster (no Git, no Argo CD).
spec:
  owner: platform-team
  type: service
  lifecycle: experimental

  parameters:
    - title: Project details
      required:
        - name
        - namespace
        - tenant
      properties:
        name:
          title: Name
          description: Project name (metadata.name)
          type: string
          ui:autofocus: true
        namespace:
          title: Namespace
          description: Target Kubernetes namespace
          type: string
          default: default
        tenant:
          title: Tenant
          description: Tenant identifier for the project
          type: string
        description:
          title: Description
          description: Optional project description
          type: string
          default: ""
        tags:
          title: Tags
          description: Optional list of tags
          type: array
          items:
            type: string
          default: []
        default:
          title: Default project
          description: Whether this is the default project
          type: boolean
          default: false

  steps:
    - id: apply-cr
      name: Apply ArubaCloud Project to cluster
      action: kube:apply
      input:
        clusterName: local-cluster
        namespaced: true
        manifest: |
          apiVersion: arubacloud.com/v1alpha1
          kind: Project
          metadata:
            name: ${{ parameters.name }}
            namespace: ${{ parameters.namespace }}
          spec:
            tenant: ${{ parameters.tenant }}
            description: ${{ parameters.description }}
            tags: ${{ parameters.tags }}
            default: ${{ parameters.default }}

  output:
    links:
      - title: Project created
        url: /
        icon: folder